WITH tbl AS (
SELECT
  d.department_name,
  e.name,
  e.salary,
  dense_rank() OVER w AS rnk 
FROM employee AS e
INNER JOIN department AS d 
  ON e.department_id = d.department_id
WINDOW w AS (
  PARTITION BY d.department_name 
  ORDER BY e.salary DESC
  )
)
  
SELECT
  department_name,
  name,
  salary
FROM tbl
WHERE rnk <= 3
ORDER BY department_name, salary DESC, name;