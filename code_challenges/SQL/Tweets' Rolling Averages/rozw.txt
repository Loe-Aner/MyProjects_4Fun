SELECT
  user_id,
  tweet_date,
  ROUND(AVG(tweet_count) OVER w, 2) AS rolling_avg_3d
FROM tweets
WINDOW w AS (
  PARTITION BY user_id
  ORDER BY tweet_date ASC
  ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
)
ORDER BY user_id ASC, tweet_date ASC;